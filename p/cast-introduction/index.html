<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Go第三方库之类型转换cast介绍。"><title>Cast Introduction</title>
<link rel=canonical href=https://arlettebrook.github.io/p/cast-introduction/><link rel=stylesheet href=/scss/style.min.59d76563977ef6a76d0c7df16aa86c7ac37ed8942ba1442046cb6cf3b07439d7.css><meta property='og:title' content="Cast Introduction"><meta property='og:description' content="Go第三方库之类型转换cast介绍。"><meta property='og:url' content='https://arlettebrook.github.io/p/cast-introduction/'><meta property='og:site_name' content="Arlettebrook's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Go第三方库'><meta property='article:published_time' content='2024-05-11T18:45:59+08:00'><meta property='article:modified_time' content='2024-05-11T18:45:59+08:00'><meta name=twitter:site content="@arlettebrook"><meta name=twitter:creator content="@arlettebrook"><meta name=twitter:title content="Cast Introduction"><meta name=twitter:description content="Go第三方库之类型转换cast介绍。"><link rel="shortcut icon" href=/img/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-9MKLLVPEER"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9MKLLVPEER")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><div id=article-toolbar style=position:sticky;top:5px;z-index:1000><a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span></a></div><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#介绍>介绍</a></li><li><a href=#快速使用>快速使用</a></li><li><a href=#基本使用>基本使用</a><ol><li><a href=#源码分析>源码分析：</a></li><li><a href=#时间和时长转换>时间和时长转换</a><ol><li><a href=#时间时长示例>时间、时长示例：</a></li></ol></li><li><a href=#转换为切片>转换为切片</a><ol><li><a href=#转换为切片示例>转换为切片示例：</a></li></ol></li><li><a href=#转为mapstringtype类型>转为<code>map[string]Type</code>类型</a></li></ol></li><li><a href=#总结>总结</a></li><li><a href=#参考>参考</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/go/ style=background-color:#f97300;color:#fff>Go
</a><a href=/categories/%E7%BC%96%E7%A8%8B/ style=background-color:#41b06e;color:#fff>编程</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/cast-introduction/>Cast Introduction</a></h2><h3 class=article-subtitle>Go第三方库之类型转换cast介绍。</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 11, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 9 分钟</time></div></footer></div></header><section class=article-content><hr><h2 id=介绍><a href=#%e4%bb%8b%e7%bb%8d class=header-anchor>#</a>
介绍</h2><p>今天我们再来介绍Steve Francia（spf13）大神的另一个库<a class=link href=https://github.com/spf13/cast target=_blank rel=noopener>cast</a>。<code>cast</code>是一个小巧、实用的类型转换库，用于将一个类型转为另一个类型。它提供了一套高效且安全的类型转换功能。 最初开发<code>cast</code>是用在<a class=link href=https://gohugo.io/ target=_blank rel=noopener>hugo</a>中的。</p><hr><h2 id=快速使用><a href=#%e5%bf%ab%e9%80%9f%e4%bd%bf%e7%94%a8 class=header-anchor>#</a>
快速使用</h2><p>先安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ go get -u github.com/spf13/cast
</span></span></code></pre></td></tr></table></div></div><p>后使用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/spf13/cast&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ToString
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>(</span><span class=s>&#34;apple&#34;</span><span class=p>))</span>            <span class=c1>// apple
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>                  <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>(</span><span class=mf>8.31</span><span class=p>))</span>               <span class=c1>// 8.31
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;one time&#34;</span><span class=p>)))</span> <span class=c1>// one time
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>(</span><span class=kc>nil</span><span class=p>))</span>                <span class=c1>// &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>foo</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>=</span> <span class=s>&#34;one more time&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToString</span><span class=p>(</span><span class=nx>foo</span><span class=p>))</span> <span class=c1>// one more time
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// ToInt
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=mi>8</span><span class=p>))</span>     <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=mf>8.31</span><span class=p>))</span>  <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=s>&#34;8&#34;</span><span class=p>))</span>   <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=kc>true</span><span class=p>))</span>  <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=kc>false</span><span class=p>))</span> <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>eight</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=nx>eight</span><span class=p>))</span> <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=kc>nil</span><span class=p>))</span>   <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>实际上，<code>cast</code>实现了多种常见类型之间的相互转换，返回最符合直觉的结果。例如：</p><ul><li><code>nil</code>转为<code>string</code>的结果为<code>""</code>，而不是<code>"nil"</code>；</li><li><code>true</code>转为<code>string</code>的结果为<code>"true"</code>，而<code>true</code>转为<code>int</code>的结果为<code>1</code>；</li><li><code>interface{}</code>转为其他类型，要看它里面存储的值类型。</li></ul><p>这些类型包括所有的基本类型（整形、浮点型、布尔值和字符串）、空接口、<code>nil</code>，时间（<code>time.Time</code>）、时长（<code>time.Duration</code>）以及它们的切片类型， 还有<code>map[string]Type</code>（其中<code>Type</code>为前面提到的类型）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kt>byte</span>     <span class=kt>bool</span>      <span class=kt>float32</span>    <span class=kt>float64</span>    <span class=kt>string</span>  
</span></span><span class=line><span class=cl><span class=kt>int8</span>     <span class=kt>int16</span>     <span class=kt>int32</span>      <span class=kt>int64</span>      <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kt>uint8</span>    <span class=kt>uint16</span>    <span class=kt>uint32</span>     <span class=kt>uint64</span>     <span class=kt>uint</span>
</span></span><span class=line><span class=cl><span class=kd>interface</span><span class=p>{}</span>   <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>  <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span>   <span class=kc>nil</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=基本使用><a href=#%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 class=header-anchor>#</a>
基本使用</h2><p><code>cast</code>提供了两组函数：</p><ul><li><code>ToType</code>（其中<code>Type</code>可以为任何支持的类型），将参数转换为<code>Type</code>类型。如果无法转换，返回<code>Type</code>类型的零值或<code>nil</code>；</li><li><code>ToTypeE</code>以 E 结尾，返回转换后的值和一个<code>error</code>。这组函数可以区分参数中实际存储了零值，还是转换失败了。</li></ul><h3 id=源码分析><a href=#%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90 class=header-anchor>#</a>
源码分析：</h3><p>实现上大部分代码都类似，<code>ToType</code>在内部调用<code>ToTypeE</code>函数，返回结果并忽略错误。<code>ToType</code>函数的实现在文件<code>cast.go</code>中， 而<code>ToTypeE</code>函数的实现在文件<code>caste.go</code>中。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=c1>// cast/cast.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>ToBool</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>v</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nf>ToBoolE</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>v</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ToDuration casts an interface to a time.Duration type.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>ToDuration</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>v</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nf>ToDurationE</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>v</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>ToTypeE</code>函数都接受任意类型的参数（<code>interface{}</code>），然后使用类型断言根据具体的类型来执行不同的转换。如果无法转换，返回错误。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// cast/caste.go
</span></span></span><span class=line><span class=cl><span class=c1>// ToBoolE casts an interface to a bool type.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>ToBoolE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>(</span><span class=kt>bool</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=p>=</span> <span class=nf>indirect</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>b</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kc>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=kc>false</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>float64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>float32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>b</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>ParseBool</span><span class=p>(</span><span class=nx>i</span><span class=p>.(</span><span class=kt>string</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>json</span><span class=p>.</span><span class=nx>Number</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>v</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>ToInt64E</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=nx>err</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>v</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to bool&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to bool&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>首先调用<code>indirect</code>函数将参数中可能的指针去掉（返回原始类型）。如果类型本身不是指针，那么直接返回。否则返回指针指向的值。 循环直到返回一个非指针的值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>indirect</span><span class=p>(</span><span class=nx>a</span> <span class=kd>interface</span><span class=p>{})</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>a</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>t</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=nx>t</span><span class=p>.</span><span class=nf>Kind</span><span class=p>()</span> <span class=o>!=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Ptr</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// Avoid creating a reflect.Value if it&#39;s not a pointer.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>v</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>ValueOf</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>v</span><span class=p>.</span><span class=nf>Kind</span><span class=p>()</span> <span class=o>==</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Ptr</span> <span class=o>&amp;&amp;</span> <span class=p>!</span><span class=nx>v</span><span class=p>.</span><span class=nf>IsNil</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>v</span> <span class=p>=</span> <span class=nx>v</span><span class=p>.</span><span class=nf>Elem</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>v</span><span class=p>.</span><span class=nf>Interface</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>所以，下面代码输出都是 8：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/spf13/cast&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>       与make的区别：
</span></span></span><span class=line><span class=cl><span class=cm>          new创建指向该类型零值的指针
</span></span></span><span class=line><span class=cl><span class=cm>          make创建指定的类型，并分配内存，用与引用类型
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl>    <span class=nx>p</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=nx>p</span> <span class=p>=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=nx>p</span><span class=p>))</span> <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>pp</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>p</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToInt</span><span class=p>(</span><span class=nx>pp</span><span class=p>))</span> <span class=c1>// 8
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=时间和时长转换><a href=#%e6%97%b6%e9%97%b4%e5%92%8c%e6%97%b6%e9%95%bf%e8%bd%ac%e6%8d%a2 class=header-anchor>#</a>
时间和时长转换</h3><p>时间类型的转换代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// cast/caste.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>ToTimeInDefaultLocationE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>location</span> <span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Location</span><span class=p>)</span> <span class=p>(</span><span class=nx>tim</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>,</span> <span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=p>=</span> <span class=nf>indirect</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>v</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>v</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nf>StringToDateInDefaultLocation</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>location</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>json</span><span class=p>.</span><span class=nx>Number</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>s</span><span class=p>,</span> <span class=nx>err1</span> <span class=o>:=</span> <span class=nf>ToInt64E</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=nx>err1</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>{},</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to Time&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>uint32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Unix</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=mi>0</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>{},</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to Time&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据传入的类型执行不同的处理：</p><ul><li>如果是<code>time.Time</code>，直接返回；</li><li>如果是整型，将参数作为时间戳（自 UTC 时间<code>1970.01.01 00:00:00</code>到现在的秒数）调用<code>time.Unix</code>生成时间。<code>Unix</code>接受两个参数，第一个参数指定秒，第二个参数指定纳秒；</li><li>如果是字符串，调用<code>StringToDateInDefaultLocation</code>函数依次尝试以下面这些时间格式调用<code>time.Parse</code>解析该字符串。如果某个格式解析成功，则返回获得的<code>time.Time</code>。否则解析失败，返回错误；</li><li>其他任何类型都无法转换为<code>time.Time</code>。</li></ul><p>字符串转换为时间：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// cast/caste.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>timeFormats</span> <span class=p>=</span> <span class=p>[]</span><span class=nx>timeFormat</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// Keep common formats at the top.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>{</span><span class=s>&#34;2006-01-02&#34;</span><span class=p>,</span> <span class=nx>timeFormatNoTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC3339</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;2006-01-02T15:04:05&#34;</span><span class=p>,</span> <span class=nx>timeFormatNoTimezone</span><span class=p>},</span> <span class=c1>// iso8601 without timezone
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC1123Z</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC1123</span><span class=p>,</span> <span class=nx>timeFormatNamedTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC822Z</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC822</span><span class=p>,</span> <span class=nx>timeFormatNamedTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC850</span><span class=p>,</span> <span class=nx>timeFormatNamedTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05.999999999 -0700 MST&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericAndNamedTimezone</span><span class=p>},</span> <span class=c1>// Time.String()
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>{</span><span class=s>&#34;2006-01-02T15:04:05-0700&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>                        <span class=c1>// RFC3339 without timezone hh:mm colon
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05Z0700&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>                        <span class=c1>// RFC3339 without T or timezone hh:mm colon
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05&#34;</span><span class=p>,</span> <span class=nx>timeFormatNoTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>ANSIC</span><span class=p>,</span> <span class=nx>timeFormatNoTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>UnixDate</span><span class=p>,</span> <span class=nx>timeFormatNamedTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>RubyDate</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05Z07:00&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;02 Jan 2006&#34;</span><span class=p>,</span> <span class=nx>timeFormatNoTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05 -07:00&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;2006-01-02 15:04:05 -0700&#34;</span><span class=p>,</span> <span class=nx>timeFormatNumericTimezone</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>Kitchen</span><span class=p>,</span> <span class=nx>timeFormatTimeOnly</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>Stamp</span><span class=p>,</span> <span class=nx>timeFormatTimeOnly</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>StampMilli</span><span class=p>,</span> <span class=nx>timeFormatTimeOnly</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>StampMicro</span><span class=p>,</span> <span class=nx>timeFormatTimeOnly</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>StampNano</span><span class=p>,</span> <span class=nx>timeFormatTimeOnly</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>StringToDateInDefaultLocation</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>location</span> <span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Location</span><span class=p>)</span> <span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nf>parseDateWith</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>location</span><span class=p>,</span> <span class=nx>timeFormats</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>parseDateWith</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>location</span> <span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Location</span><span class=p>,</span> <span class=nx>formats</span> <span class=p>[]</span><span class=nx>timeFormat</span><span class=p>)</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>,</span> <span class=nx>e</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>format</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>formats</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=nx>format</span><span class=p>.</span><span class=nx>format</span><span class=p>,</span> <span class=nx>s</span><span class=p>);</span> <span class=nx>e</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>// Some time formats have a zone name, but no offset, so it gets
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=c1>// put in that zone name (not the default one passed in to us), but
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=c1>// without that zone&#39;s offset. So set the location manually.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=nx>format</span><span class=p>.</span><span class=nx>typ</span> <span class=o>&lt;=</span> <span class=nx>timeFormatNamedTimezone</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=nx>location</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>location</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Local</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nx>year</span><span class=p>,</span> <span class=nx>month</span><span class=p>,</span> <span class=nx>day</span> <span class=o>:=</span> <span class=nx>d</span><span class=p>.</span><span class=nf>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>				<span class=nx>hour</span><span class=p>,</span> <span class=nx>min</span><span class=p>,</span> <span class=nx>sec</span> <span class=o>:=</span> <span class=nx>d</span><span class=p>.</span><span class=nf>Clock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>				<span class=nx>d</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Date</span><span class=p>(</span><span class=nx>year</span><span class=p>,</span> <span class=nx>month</span><span class=p>,</span> <span class=nx>day</span><span class=p>,</span> <span class=nx>hour</span><span class=p>,</span> <span class=nx>min</span><span class=p>,</span> <span class=nx>sec</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nf>Nanosecond</span><span class=p>(),</span> <span class=nx>location</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=k>return</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to parse date: %s&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>时长类型的转换代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// cast/caste.go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>ToDurationE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>,</span> <span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=p>=</span> <span class=nf>indirect</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>s</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>s</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int64</span><span class=p>,</span> <span class=kt>int32</span><span class=p>,</span> <span class=kt>int16</span><span class=p>,</span> <span class=kt>int8</span><span class=p>,</span> <span class=kt>uint</span><span class=p>,</span> <span class=kt>uint64</span><span class=p>,</span> <span class=kt>uint32</span><span class=p>,</span> <span class=kt>uint16</span><span class=p>,</span> <span class=kt>uint8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>d</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Duration</span><span class=p>(</span><span class=nf>ToInt64</span><span class=p>(</span><span class=nx>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>float32</span><span class=p>,</span> <span class=kt>float64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>d</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Duration</span><span class=p>(</span><span class=nf>ToFloat64</span><span class=p>(</span><span class=nx>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=s>&#34;nsuµmh&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>d</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>ParseDuration</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>d</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>ParseDuration</span><span class=p>(</span><span class=nx>s</span> <span class=o>+</span> <span class=s>&#34;ns&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>json</span><span class=p>.</span><span class=nx>Number</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=kd>var</span> <span class=nx>v</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl>       <span class=nx>v</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>s</span><span class=p>.</span><span class=nf>Float64</span><span class=p>()</span>
</span></span><span class=line><span class=cl>       <span class=nx>d</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Duration</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>err</span> <span class=p>=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to Duration&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据传入的类型进行不同的处理：</p><ul><li>如果是<code>time.Duration</code>类型，直接返回；</li><li>如果是整型或浮点型，将其数值强制转换为<code>time.Duration</code>类型，单位默认为<code>ns</code>；</li><li>如果是字符串，分为两种情况：如果字符串中有时间单位符号<code>nsuµmh</code>，直接调用<code>time.ParseDuration</code>解析；否则在字符串后拼接<code>ns</code>再调用<code>time.ParseDuration</code>解析；</li><li>其他类型解析失败。</li></ul><h4 id=时间时长示例><a href=#%e6%97%b6%e9%97%b4%e6%97%b6%e9%95%bf%e7%a4%ba%e4%be%8b class=header-anchor>#</a>
时间、时长示例：</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/spf13/cast&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>timestamp</span> <span class=o>:=</span> <span class=mi>1579615973</span>
</span></span><span class=line><span class=cl>    <span class=nx>timeStr</span> <span class=o>:=</span> <span class=s>&#34;2020-01-21 22:13:48&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToTime</span><span class=p>(</span><span class=nx>now</span><span class=p>))</span>       <span class=c1>// 2020-01-22 06:31:50.5068465 +0800 CST m=+0.000997701
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToTime</span><span class=p>(</span><span class=nx>timestamp</span><span class=p>))</span> <span class=c1>// 2020-01-21 22:12:53 +0800 CST
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToTime</span><span class=p>(</span><span class=nx>timeStr</span><span class=p>))</span>   <span class=c1>// 2020-01-21 22:13:48 +0000 UTC
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>d</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>ParseDuration</span><span class=p>(</span><span class=s>&#34;1m30s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ns</span> <span class=o>:=</span> <span class=mi>30000</span>
</span></span><span class=line><span class=cl>    <span class=nx>strWithS</span> <span class=o>:=</span> <span class=s>&#34;130s&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>strWithoutNs</span> <span class=o>:=</span> <span class=s>&#34;130&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDuration</span><span class=p>(</span><span class=nx>d</span><span class=p>))</span>            <span class=c1>// 1m30s
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDuration</span><span class=p>(</span><span class=nx>ns</span><span class=p>))</span>           <span class=c1>// 30µs
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDuration</span><span class=p>(</span><span class=nx>strWithS</span><span class=p>))</span>     <span class=c1>// 2m10s
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDuration</span><span class=p>(</span><span class=nx>strWithoutNs</span><span class=p>))</span> <span class=c1>// 130ns
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=转换为切片><a href=#%e8%bd%ac%e6%8d%a2%e4%b8%ba%e5%88%87%e7%89%87 class=header-anchor>#</a>
转换为切片</h3><p>实际上，这些函数的实现基本类似。使用类型断言判断类型。如果就是要返回的类型，直接返回。否则根据类型进行相应的转换。</p><p>我们主要分析两个实现：<code>ToIntSliceE</code>和<code>ToStringSliceE</code>。<code>ToBoolSliceE/ToDurationSliceE</code>与<code>ToIntSliceE</code>基本相同。</p><p>首先是<code>ToIntSliceE</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>ToIntSliceE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>i</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{},</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to []int&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>v</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>v</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>kind</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>i</span><span class=p>).</span><span class=nf>Kind</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>kind</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Slice</span><span class=p>,</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Array</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>s</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>ValueOf</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=nx>a</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nf>Len</span><span class=p>())</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=p>&lt;</span> <span class=nx>s</span><span class=p>.</span><span class=nf>Len</span><span class=p>();</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>val</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>ToIntE</span><span class=p>(</span><span class=nx>s</span><span class=p>.</span><span class=nf>Index</span><span class=p>(</span><span class=nx>j</span><span class=p>).</span><span class=nf>Interface</span><span class=p>())</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=k>return</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{},</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to []int&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>val</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{},</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to []int&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据传入参数的类型：</p><ul><li>如果是<code>nil</code>，直接返回错误；</li><li>如果是<code>[]int</code>，不用转换，直接返回；</li><li>如果传入类型为<strong>切片</strong>或<strong>数组</strong>，新建一个<code>[]int</code>，将切片或数组中的每个元素转为<code>int</code>放到该<code>[]int</code>中。最后返回这个<code>[]int</code>；</li><li>其他情况，不能转换。</li></ul><p><code>ToStringSliceE</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>ToStringSliceE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>v</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>v</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>int8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>int32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>int64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>float32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>u</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=nx>v</span><span class=p>),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>[]</span><span class=kt>error</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>i</span><span class=p>.([]</span><span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>a</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nf>Error</span><span class=p>())</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kd>interface</span><span class=p>{}:</span>
</span></span><span class=line><span class=cl>       <span class=nx>str</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>ToStringE</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to []string&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=nx>str</span><span class=p>},</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to []string&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据传入的参数类型：</p><ul><li>如果是<code>[]interface{}</code>，将该参数中每个元素转为<code>string</code>，返回结果切片；</li><li>如果是<code>[]string</code>，不需要转换，直接返回；</li><li>如果是<code>interface{}</code>，将参数转为<code>string</code>，返回只包含这个值的切片；</li><li>如果是<code>string</code>，调用<code>strings.Fields</code>函数按空白符将参数拆分，返回拆分后的字符串切片；</li><li>其他情况，不能转换。</li></ul><h4 id=转换为切片示例><a href=#%e8%bd%ac%e6%8d%a2%e4%b8%ba%e5%88%87%e7%89%87%e7%a4%ba%e4%be%8b class=header-anchor>#</a>
转换为切片示例：</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/spf13/cast&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sliceOfInt</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>arrayOfInt</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>8</span><span class=p>,</span> <span class=mi>12</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ToIntSlice
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToIntSlice</span><span class=p>(</span><span class=nx>sliceOfInt</span><span class=p>))</span> <span class=c1>// [1 3 7]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToIntSlice</span><span class=p>(</span><span class=nx>arrayOfInt</span><span class=p>))</span> <span class=c1>// [8 12 0]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>sliceOfInterface</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>interface</span><span class=p>{}{</span><span class=mi>1</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s>&#34;apple&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sliceOfString</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;abc&#34;</span><span class=p>,</span> <span class=s>&#34;dj&#34;</span><span class=p>,</span> <span class=s>&#34;banana&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>stringFields</span> <span class=o>:=</span> <span class=s>&#34; abc  def hij   hah&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>common</span> <span class=o>:=</span> <span class=kd>interface</span><span class=p>{}(</span><span class=mi>37</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ToStringSliceE
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringSlice</span><span class=p>(</span><span class=nx>sliceOfInterface</span><span class=p>))</span> <span class=c1>// [1 2 apple]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringSlice</span><span class=p>(</span><span class=nx>sliceOfString</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>toStringFields</span> <span class=o>:=</span> <span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringSlice</span><span class=p>(</span><span class=nx>stringFields</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>toStringFields</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>toStringFields</span><span class=p>))</span> <span class=c1>// [abc dj banana hah] 4                    // [abc def hij]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringSlice</span><span class=p>(</span><span class=nx>common</span><span class=p>))</span>          <span class=c1>// [37]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// ToToDurationSlice
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stringDurationSlice</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;1m23s&#34;</span><span class=p>,</span> <span class=s>&#34;22h&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>intDurationArray</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>222222222</span><span class=p>,</span> <span class=mi>88383838888</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDurationSlice</span><span class=p>(</span><span class=nx>stringDurationSlice</span><span class=p>))</span> <span class=c1>// [1m23s 22h0m0s]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToDurationSlice</span><span class=p>(</span><span class=nx>intDurationArray</span><span class=p>))</span>    <span class=c1>// [222.222222ms 1m28.383838888s 0s]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>//
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stringBoolSlice</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;true&#34;</span><span class=p>,</span> <span class=s>&#34;false&#34;</span><span class=p>,</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;0&#34;</span><span class=p>,</span> <span class=s>&#34;T&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>intBoolArray</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>22</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToBoolSlice</span><span class=p>(</span><span class=nx>stringBoolSlice</span><span class=p>))</span> <span class=c1>// /*[true false true false true]*/
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToBoolSlice</span><span class=p>(</span><span class=nx>intBoolArray</span><span class=p>))</span>    <span class=c1>// [true false true]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=转为mapstringtype类型><a href=#%e8%bd%ac%e4%b8%bamapstringtype%e7%b1%bb%e5%9e%8b class=header-anchor>#</a>
转为<code>map[string]Type</code>类型</h3><p><code>cast</code>库能将传入的参数转为<code>map[string]Type</code>类型，<code>Type</code>为上面支持的类型。</p><p>其实只需要分析一个<code>ToStringMapStringE</code>函数就可以了，其他的实现基本一样。<code>ToStringMapStringE</code>返回<code>map[string]string</code>类型的值。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>ToStringMapStringE</span><span class=p>(</span><span class=nx>i</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>m</span> <span class=p>=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>v</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>v</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>val</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>m</span><span class=p>[</span><span class=nf>ToString</span><span class=p>(</span><span class=nx>k</span><span class=p>)]</span> <span class=p>=</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>m</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kd>map</span><span class=p>[</span><span class=kd>interface</span><span class=p>{}]</span><span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>val</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>m</span><span class=p>[</span><span class=nf>ToString</span><span class=p>(</span><span class=nx>k</span><span class=p>)]</span> <span class=p>=</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>m</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kd>map</span><span class=p>[</span><span class=kd>interface</span><span class=p>{}]</span><span class=kd>interface</span><span class=p>{}:</span>
</span></span><span class=line><span class=cl>       <span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>val</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>v</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>m</span><span class=p>[</span><span class=nf>ToString</span><span class=p>(</span><span class=nx>k</span><span class=p>)]</span> <span class=p>=</span> <span class=nf>ToString</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>m</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=kt>string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=nx>err</span> <span class=o>:=</span> <span class=nf>jsonStringToObject</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=k>return</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;unable to cast %#v of type %T to map[string]string&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>根据传入的参数类型：</p><ul><li>如果是<code>map[string]string</code>，不用转换，直接返回；</li><li>如果是<code>map[string]interface{}</code>，将每个值转为<code>string</code>存入新的 map，最后返回新的 map；</li><li>如果是<code>map[interface{}]string</code>，将每个键转为<code>string</code>存入新的 map，最后返回新的 map；</li><li>如果是<code>map[interface{}]interface{}</code>，将每个键和值都转为<code>string</code>存入新的 map，最后返回新的 map；</li><li><strong>如果是<code>string</code>类型，<code>cast</code>将它看成一个 JSON 串，解析这个 JSON 到<code>map[string]string</code>，然后返回结果</strong>；</li><li>其他情况，返回错误。</li></ul><p>转换为映射示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/spf13/cast&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>m1</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;name&#34;</span><span class=p>:</span> <span class=s>&#34;apple&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;job&#34;</span><span class=p>:</span>  <span class=s>&#34;developer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>m2</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}{</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;name&#34;</span><span class=p>:</span> <span class=s>&#34;banana&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;age&#34;</span><span class=p>:</span>  <span class=mi>18</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>m3</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kd>interface</span><span class=p>{}]</span><span class=kt>string</span><span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;name&#34;</span><span class=p>:</span> <span class=s>&#34;orange&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;job&#34;</span><span class=p>:</span>  <span class=s>&#34;designer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>m4</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=nx>any</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}{</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;name&#34;</span><span class=p>:</span> <span class=s>&#34;strawberry&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;age&#34;</span><span class=p>:</span>  <span class=mi>29</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=mi>18</span><span class=p>:</span>     <span class=s>&#34;hi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jsonStr</span> <span class=o>:=</span> <span class=s>`{&#34;name&#34;:&#34;bibi&#34;, &#34;job&#34;:&#34;manager&#34;}`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringMapString</span><span class=p>(</span><span class=nx>m1</span><span class=p>))</span>      <span class=c1>// map[job:developer name:apple]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringMapString</span><span class=p>(</span><span class=nx>m2</span><span class=p>))</span>      <span class=c1>// map[age:18 name:banana]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringMapString</span><span class=p>(</span><span class=nx>m3</span><span class=p>))</span>      <span class=c1>// map[job:designer name:orange]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringMapString</span><span class=p>(</span><span class=nx>m4</span><span class=p>))</span>      <span class=c1>// map[18:hi age:29 name:strawberry]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>cast</span><span class=p>.</span><span class=nf>ToStringMapString</span><span class=p>(</span><span class=nx>jsonStr</span><span class=p>))</span> <span class=c1>// map[job:manager name:bibi]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=总结><a href=#%e6%80%bb%e7%bb%93 class=header-anchor>#</a>
总结</h2><p><code>cast</code>库能在几乎所有常见类型之间转换，使用非常方便。代码量也很小，有时间建议读读源码。常用于解析配置数据。</p><hr><h2 id=参考><a href=#%e5%8f%82%e8%80%83 class=header-anchor>#</a>
参考</h2><blockquote><ol><li><a class=link href=https://github.com/spf13/cast target=_blank rel=noopener>cast</a> GitHub 仓库</li><li>原作者：<a class=link href=https://darjun.github.io/2020/01/20/godailylib/cast/ target=_blank rel=noopener>Go 每日一库之 cast</a></li></ol></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/go%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/>Go第三方库</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/gin-introduction/><div class=article-details><h2 class=article-title>Gin Introduction</h2></div></a></article><article><a href=/p/go-ini-introduction/><div class=article-details><h2 class=article-title>Go-ini Introduction</h2></div></a></article><article><a href=/p/carbon-introduction/><div class=article-details><h2 class=article-title>Carbon Introduction</h2></div></a></article><article><a href=/p/godotenv-introduction/><div class=article-details><h2 class=article-title>Godotenv Introduction</h2></div></a></article><article><a href=/p/logrus-introduction/><div class=article-details><h2 class=article-title>Logrus Introduction</h2></div></a></article></div></div></aside><script src=//unpkg.com/@waline/client@v2/dist/waline.js></script><link href=//unpkg.com/@waline/client@v2/dist/waline.css rel=stylesheet><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding);--waline-font-size:var(--article-font-size)}.waline-container .wl-count{color:var(--card-text-color-main)}</style><script>Waline.init({copyright:!1,dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://unpkg.com/@waline/emojis@1.0.1/weibo"],lang:"zh-cn",locale:{admin:"👻Hi",placeholder:"🎉留下你的脚印..."},pageview:!0,requiredMeta:["name","email"],serverURL:"https://waline.nek.us.kg/"})</script><footer class=site-footer><section class=copyright>Copyright &copy;
2020 -
2024 <b><a href=https://github.com/arlettebrook target=_blank rel=noopener>@Arlettebrook</a></b></section><section class=powerby>博客内容遵循<b><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-hans target=_blank rel=noopener> 知识共享 署名-非商业性-相同方式共享4.0国际协议</a></b><br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>